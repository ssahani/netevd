name: Stale Issues and PRs

on:
  schedule:
    # Run daily at 1 AM UTC
    - cron: '0 1 * * *'
  workflow_dispatch:

permissions:
  issues: write
  pull-requests: write

jobs:
  stale:
    name: Mark Stale Issues and PRs
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v9
        with:
          repo-token: ${{ secrets.GITHUB_TOKEN }}

          # Issues
          days-before-issue-stale: 90
          days-before-issue-close: 14
          stale-issue-label: 'stale'
          exempt-issue-labels: 'pinned,security,roadmap'
          stale-issue-message: |
            This issue has been automatically marked as stale because it has not had
            recent activity in the last 90 days. It will be closed in 14 days if no
            further activity occurs.

            If this issue is still relevant, please:
            - Comment to keep it open
            - Add the 'pinned' label to prevent it from becoming stale
            - Provide additional context or updates

            Thank you for your contributions!

          close-issue-message: |
            This issue was automatically closed because it has been stale for 14 days
            with no activity.

            If you believe this issue should be reopened, please create a new issue
            with updated information and reference this one.

          # Pull Requests
          days-before-pr-stale: 60
          days-before-pr-close: 14
          stale-pr-label: 'stale'
          exempt-pr-labels: 'pinned,security,in-progress'
          stale-pr-message: |
            This pull request has been automatically marked as stale because it has not
            had recent activity in the last 60 days. It will be closed in 14 days if no
            further activity occurs.

            If this PR is still being worked on, please:
            - Comment or push new commits
            - Add the 'in-progress' label
            - Rebase on the latest main branch

            Thank you for your contribution!

          close-pr-message: |
            This pull request was automatically closed because it has been stale for
            14 days with no activity.

            If you'd like to continue this work, please rebase on the latest main
            branch and open a new PR.

          # Operations
          operations-per-run: 100
          ascending: true
